<div class="container">
  <h1>{{ title }}</h1>

  <div
    id="status"
    class="status"
    [ngClass]="{
      'connected': status() === 'connected',
      'disconnected': status() === 'disconnected',
      'reconnecting': status() === 'reconnecting'
    }">
    Status: {{ status() | titlecase }}
  </div>

  <!-- Unary RPC Section -->
  <div class="section">
    <h2>Unary RPC (SayHello)</h2>
    <div class="input-group">
      <input
        id="greetingNameInput"
        type="text"
        [(ngModel)]="greetingName"
        placeholder="Enter name"
        class="name-input">
        <button
          id="sayHelloBtn"
          class="start"
          (click)="sayHello()"
          [disabled]="status() !== 'connected'">
          Say Hello
        </button>
      </div>
      @if (greetingResponse()) {
        <div id="greetingResponse" class="response">{{ greetingResponse() }}</div>
      }
      @if (greetingError()) {
        <div id="greetingError" class="error">Error: {{ greetingError() }}</div>
      }
    </div>

    <!-- Server Streaming Section -->
    <div class="section">
      <h2>Server Streaming (InfiniteTicker)</h2>
      <div class="button-group">
        <button
          id="startBtn"
          class="start"
          (click)="startTicker()"
          [disabled]="isTickerActive">
          Start Ticker
        </button>
        <button
          id="stopBtn"
          class="stop"
          (click)="stopTicker()"
          [disabled]="!isTickerActive">
          Stop Ticker
        </button>
      </div>

      <div>
        <h3>Tick Count:</h3>
        <div id="counter" class="counter">{{ tickCount() }}</div>
      </div>

      <div>
        <h3>Last Update:</h3>
        <div id="timestamp">{{ lastTimestamp() }}</div>
      </div>
    </div>

    <!-- Concurrent Streams Section -->
    <div class="section">
      <h2>Concurrent Streams</h2>
      <div class="streams-container">
        <div class="stream">
          <h3>Stream 1</h3>
          <div class="button-group">
            <button
              id="startStream1Btn"
              class="start"
              (click)="startStream1()"
              [disabled]="stream1Active()">
              Start
            </button>
            <button
              id="stopStream1Btn"
              class="stop"
              (click)="stopStream1()"
              [disabled]="!stream1Active()">
              Stop
            </button>
          </div>
          <div id="stream1Counter" class="counter">{{ stream1Count() }}</div>
        </div>

        <div class="stream">
          <h3>Stream 2</h3>
          <div class="button-group">
            <button
              id="startStream2Btn"
              class="start"
              (click)="startStream2()"
              [disabled]="stream2Active()">
              Start
            </button>
            <button
              id="stopStream2Btn"
              class="stop"
              (click)="stopStream2()"
              [disabled]="!stream2Active()">
              Stop
            </button>
          </div>
          <div id="stream2Counter" class="counter">{{ stream2Count() }}</div>
        </div>
      </div>
    </div>

    <!-- requestSignal Examples Section -->
    <div class="section">
      <h2>requestSignal Examples</h2>

      <!-- Unary RPC with requestSignal -->
      <div class="subsection">
        <h3>Unary RPC with requestSignal</h3>
        <div class="input-group">
          <input
            id="signalGreetingNameInput"
            type="text"
            [(ngModel)]="signalGreetingName"
            placeholder="Enter name"
            class="name-input">
          <button
            id="sayHelloSignalBtn"
            class="start"
            (click)="sayHelloWithSignal()"
            [disabled]="status() !== 'connected'">
            Say Hello (Signal)
          </button>
        </div>
        @if (signalGreetingResponse()) {
          <div id="signalGreetingResponse" class="response">{{ signalGreetingResponse()?.message }}</div>
        }
      </div>

      <!-- Server Streaming with requestSignal -->
      <div class="subsection">
        <h3>Server Streaming with requestSignal</h3>
        <div class="button-group">
          <button
            id="startSignalStreamBtn"
            class="start"
            (click)="startSignalStream()"
            [disabled]="signalStreamActive()">
            Start Stream (Signal)
          </button>
          <button
            id="stopSignalStreamBtn"
            class="stop"
            (click)="stopSignalStream()"
            [disabled]="!signalStreamActive()">
            Stop Stream (Signal)
          </button>
        </div>
        @if (signalStreamTick()) {
          <div>
            <h4>Signal Stream Tick Count:</h4>
            <div id="signalStreamCounter" class="counter">{{ signalStreamTick()?.count }}</div>
          </div>
          <div>
            <h4>Signal Stream Timestamp:</h4>
            <div id="signalStreamTimestamp">{{ signalStreamTick()?.timestamp }}</div>
          </div>
        }
      </div>
    </div>
  </div>
